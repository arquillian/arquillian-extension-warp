<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <parent>
    <groupId>org.jboss.arquillian.extension</groupId>
    <artifactId>arquillian-warp-build</artifactId>
    <version>1.0.1-SNAPSHOT</version>
    <relativePath>..</relativePath>
  </parent>

  <artifactId>arquillian-warp-ftest-base</artifactId>
  <name>Arquillian Warp: Functional Test Base</name>
  <packaging>pom</packaging>

  <properties>
    <version.shrinkwrap>1.2.6</version.shrinkwrap>
    <version.shrinkwrap.descriptors>2.0.0</version.shrinkwrap.descriptors>
    <version.arquillian.glassfish40>1.0.2</version.arquillian.glassfish40>

    <!-- Arquillian Configuration -->
    <arquillian.debug>false</arquillian.debug>
    <arquillian.drone.browser>htmlUnit</arquillian.drone.browser>
    <arquillian.drone.reusable>false</arquillian.drone.reusable>
    <arquillian.richfaces.servletContainerSetup>false</arquillian.richfaces.servletContainerSetup>
    <arquillian.richfaces.jsfImplementation>org.glassfish:javax.faces</arquillian.richfaces.jsfImplementation>
    <arquillian.container.home />
    <arquillian.container.distribution />
    <arquillian.container.configuration />
    <arquillian.container.uninstall>true</arquillian.container.uninstall>
    <arquillian.container.vmargs>-Xmx768m -Darquillian.debug=${arquillian.debug}
    </arquillian.container.vmargs>
    <arquillian.contaner.maxTestClassesBeforeRestart>50</arquillian.contaner.maxTestClassesBeforeRestart>

    <!-- Container Selection -->
    <arquillian.launch.wildfly>false</arquillian.launch.wildfly>
    <arquillian.launch.tomcat6>false</arquillian.launch.tomcat6>
    <arquillian.launch.tomcat7>false</arquillian.launch.tomcat7>
    <arquillian.launch.tomee>false</arquillian.launch.tomee>
    <arquillian.launch.glassfish40>false</arquillian.launch.glassfish40>
  </properties>

  <dependencyManagement>
    <dependencies>
      <dependency>
        <groupId>org.jboss.arquillian.extension</groupId>
        <artifactId>arquillian-warp-build</artifactId>
        <version>${project.version}</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>
      <!-- Integration Tests - Version Management -->
      <dependency>
        <groupId>org.jboss.shrinkwrap</groupId>
        <artifactId>shrinkwrap-bom</artifactId>
        <version>${version.shrinkwrap}</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap.descriptors</groupId>
        <artifactId>shrinkwrap-descriptors-bom</artifactId>
        <version>${version.shrinkwrap.descriptors}</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap.descriptors</groupId>
        <artifactId>shrinkwrap-descriptors-depchain</artifactId>
        <type>pom</type>
        <version>${version.shrinkwrap.descriptors}</version>
      </dependency>
      <!--LittleProxy logging is done by Log4J: -->
      <dependency>
        <groupId>org.apache.logging.log4j</groupId>
        <artifactId>log4j-bom</artifactId>
        <version>${version.log4j}</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>
    </dependencies>
  </dependencyManagement>

  <build>
    <testResources>
      <testResource>
        <directory>src/test/resources</directory>
        <filtering>true</filtering>
      </testResource>
      <testResource>
        <directory>src/test/arquillian-settings/</directory>
        <filtering>true</filtering>
      </testResource>
    </testResources>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-dependency-plugin</artifactId>
        <executions>
          <execution>
            <id>unpack-arquillian-settings</id>
            <phase>initialize</phase>
            <goals>
              <goal>unpack</goal>
            </goals>
            <configuration>
              <artifactItems>
                <artifactItem>
                  <groupId>org.jboss.arquillian.extension</groupId>
                  <artifactId>arquillian-warp-build-resources</artifactId>
                  <version>${project.version}</version>
                  <type>jar</type>
                  <overWrite>true</overWrite>
                </artifactItem>
              </artifactItems>
              <includes>arquillian.xml</includes>
              <outputDirectory>src/test/arquillian-settings</outputDirectory>
            </configuration>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>

  <profiles>

    <!-- Containers -->

    <profile>
      <id>wildfly-managed</id>
      <activation>
        <activeByDefault>true</activeByDefault>
        <property>
          <name>integration</name>
          <value>wildfly</value>
        </property>
      </activation>
      <properties>
        <arquillian.launch.wildfly>true</arquillian.launch.wildfly>
        <arquillian.container.home>${project.build.directory}/wildfly-${version.wildfly}</arquillian.container.home>
        <arquillian.container.distribution>org.wildfly:wildfly-dist:zip:${version.wildfly}
        </arquillian.container.distribution>
      </properties>
      <dependencies>
        <dependency>
          <groupId>org.wildfly.arquillian</groupId>
          <artifactId>wildfly-arquillian-container-managed</artifactId>
          <version>${version.wildfly.arquillian.container}</version>
          <scope>test</scope>
        </dependency>
        <!--The dependency on the servlet api must be declared for each profile, see detailed explanation in the
            test "org.jboss.arquillian.warp.jsf.ftest.lifecycle.TestFacesLifecycleFailurePropagation" in "jsf-ftest" project.
         -->
        <dependency>
          <groupId>org.jboss.spec.javax.servlet</groupId>
          <artifactId>jboss-servlet-api_3.0_spec</artifactId>
          <scope>provided</scope>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>wildfly-remote</id>
      <dependencies>
        <dependency>
          <groupId>org.wildfly.arquillian</groupId>
          <artifactId>wildfly-arquillian-container-remote</artifactId>
          <version>${version.wildfly.arquillian.container}</version>
          <scope>test</scope>
        </dependency>
        <!--The dependency on the servlet api must be declared for each profile, see detailed explanation in the
            test "org.jboss.arquillian.warp.jsf.ftest.lifecycle.TestFacesLifecycleFailurePropagation" in "jsf-ftest" project.
         -->
        <dependency>
          <groupId>org.jboss.spec.javax.servlet</groupId>
          <artifactId>jboss-servlet-api_3.0_spec</artifactId>
          <scope>provided</scope>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>tomee-managed</id>
      <activation>
        <property>
          <name>integration</name>
          <value>tomee</value>
        </property>
      </activation>
      <properties>
        <arquillian.launch.tomee>true</arquillian.launch.tomee>
        <arquillian.richfaces.jsfProvider>myfaces</arquillian.richfaces.jsfProvider>
        <arquillian.container.home>${project.build.directory}/apache-tomee-webprofile-${version.tomee}
        </arquillian.container.home>
        <arquillian.container.distribution>org.apache.tomee:apache-tomee:zip:webprofile:${version.tomee}
        </arquillian.container.distribution>
      </properties>
      <dependencies>
        <dependency>
          <groupId>org.apache.tomee</groupId>
          <artifactId>arquillian-tomee-remote</artifactId>
          <version>${version.tomee}</version>
          <scope>test</scope>
        </dependency>
        <!--The dependency on the servlet api must be declared for each profile, see detailed explanation in the
            test "org.jboss.arquillian.warp.jsf.ftest.lifecycle.TestFacesLifecycleFailurePropagation" in "jsf-ftest" project.
         -->
        <dependency>
          <groupId>org.apache.tomcat</groupId>
          <artifactId>tomcat-servlet-api</artifactId>
          <scope>provided</scope>
          <version>${version.tomee}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>glassfish-managed-4-0</id>
      <activation>
        <property>
          <name>integration</name>
          <value>glassfish40</value>
        </property>
      </activation>
      <properties>
        <arquillian.launch.glassfish40>true</arquillian.launch.glassfish40>
        <arquillian.container.home>${project.build.directory}/glassfish4</arquillian.container.home>
        <arquillian.container.distribution>org.glassfish.main.distributions:glassfish:zip:${version.glassfish40}
        </arquillian.container.distribution>
      </properties>
      <dependencies>
        <dependency>
          <groupId>org.jboss.arquillian.container</groupId>
          <artifactId>arquillian-glassfish-managed-3.1</artifactId>
          <version>${version.arquillian.glassfish40}</version>
          <scope>test</scope>
        </dependency>
        <!--The dependency on the servlet api must be declared for each profile, see detailed explanation in the
            test "org.jboss.arquillian.warp.jsf.ftest.lifecycle.TestFacesLifecycleFailurePropagation" in "jsf-ftest" project.
         -->
        <dependency>
          <groupId>javax.servlet</groupId>
          <artifactId>javax.servlet-api</artifactId>
          <scope>provided</scope>
          <version>${version.glassfish40_servlet_api}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>glassfish-remote-4-0</id>
      <activation>
        <property>
          <name>integration</name>
          <value>glassfish40-remote</value>
        </property>
      </activation>
      <properties>
        <arquillian.launch.glassfish40>true</arquillian.launch.glassfish40>
      </properties>
      <dependencies>
        <dependency>
          <groupId>org.jboss.arquillian.container</groupId>
          <artifactId>arquillian-glassfish-remote-3.1</artifactId>
          <version>${version.arquillian.glassfish40}</version>
          <scope>test</scope>
        </dependency>
        <!--The dependency on the servlet api must be declared for each profile, see detailed explanation in the
            test "org.jboss.arquillian.warp.jsf.ftest.lifecycle.TestFacesLifecycleFailurePropagation" in "jsf-ftest" project.
         -->
        <dependency>
          <groupId>javax.servlet</groupId>
          <artifactId>javax.servlet-api</artifactId>
          <scope>provided</scope>
          <version>${version.glassfish40_servlet_api}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>tomcat-remote-6</id>
      <activation>
        <property>
          <name>integration</name>
          <value>tomcat6-remote</value>
        </property>
      </activation>
      <properties>
        <arquillian.launch.tomcat6>true</arquillian.launch.tomcat6>
        <arquillian.richfaces.servletContainerSetup>true</arquillian.richfaces.servletContainerSetup>
      </properties>
      <dependencies>
        <dependency>
          <groupId>org.jboss.arquillian.container</groupId>
          <artifactId>arquillian-tomcat-remote-6</artifactId>
          <version>1.1.0.Final</version>
          <scope>test</scope>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>tomcat-managed-6</id>
      <activation>
        <property>
          <name>integration</name>
          <value>tomcat6</value>
        </property>
      </activation>
      <properties>
        <arquillian.launch.tomcat6>true</arquillian.launch.tomcat6>
        <arquillian.richfaces.servletContainerSetup>true</arquillian.richfaces.servletContainerSetup>
        <arquillian.container.home>${project.build.directory}/apache-tomcat-${version.tomcat6}
        </arquillian.container.home>
        <arquillian.container.distribution>com.googlecode.t7mp:tomcat:zip:${version.tomcat6}
        </arquillian.container.distribution>
        <arquillian.container.configuration>
          org.richfaces:richfaces-build-resources:zip:configuration-tomcat:${version.richfaces}
        </arquillian.container.configuration>
      </properties>
      <dependencies>
        <dependency>
          <groupId>org.jboss.arquillian.container</groupId>
          <artifactId>arquillian-tomcat-managed-6</artifactId>
          <version>1.1.0.Final</version>
          <scope>test</scope>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>tomcat-managed-7</id>
      <activation>
        <property>
          <name>integration</name>
          <value>tomcat7</value>
        </property>
      </activation>
      <properties>
        <catalinaHome>${project.build.directory}/apache-tomcat-${version.tomcat7}</catalinaHome>
        <arquillian.launch.tomcat7>true</arquillian.launch.tomcat7>
        <arquillian.richfaces.servletContainerSetup>true</arquillian.richfaces.servletContainerSetup>
        <arquillian.container.home>${project.build.directory}/apache-tomcat-${version.tomcat7}
        </arquillian.container.home>
        <arquillian.container.distribution>com.googlecode.t7mp:tomcat:zip:${version.tomcat7}
        </arquillian.container.distribution>
        <arquillian.container.configuration>
          org.richfaces:richfaces-build-resources:zip:configuration-tomcat:${version.richfaces}
        </arquillian.container.configuration>
      </properties>
      <dependencies>
        <dependency>
          <groupId>org.jboss.arquillian.container</groupId>
          <artifactId>arquillian-tomcat-managed-7</artifactId>
          <version>1.1.0.Final</version>
          <scope>test</scope>
        </dependency>
      </dependencies>
    </profile>

    <profile>
      <id>browser-chrome</id>
      <activation>
        <property>
          <name>browser</name>
          <value>chrome</value>
        </property>
      </activation>
      <properties>
        <arquillian.drone.browser>chrome</arquillian.drone.browser>
      </properties>
    </profile>

    <profile>
      <id>browser-firefox</id>
      <activation>
        <property>
          <name>browser</name>
          <value>firefox</value>
        </property>
      </activation>
      <properties>
        <arquillian.drone.browser>firefox</arquillian.drone.browser>
      </properties>
    </profile>

    <profile>
      <id>browser-remote-reusable</id>
      <properties>
        <arquillian.drone.reusable>true</arquillian.drone.reusable>
      </properties>
    </profile>

    <profile>
      <id>arquillian-debug</id>
      <activation>
        <property>
          <name>arquillian.debug</name>
        </property>
      </activation>
      <build>
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <configuration>
              <systemProperties>
                <property>
                  <name>java.util.logging.config.file</name>
                  <value>src/test/resources/logging.properties</value>
                </property>
              </systemProperties>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>

  </profiles>
</project>